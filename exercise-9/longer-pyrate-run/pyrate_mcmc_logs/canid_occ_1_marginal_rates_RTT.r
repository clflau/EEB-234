# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.151983543439, 0.151983543439,0.151983543439,0.151466252085,0.13676320959,0.0527884334363,0.0432964169158,0.0426439610131,0.0431916674255,0.0431916674255,0.0431916674255,0.0431916674255,0.0431916674255,0.0487882562319,0.0497039751175,0.0531561201099,0.0569995774007,0.0621281316099,0.0666864948857,0.0644975530722,0.0790003476378,0.0967556054721,0.0970436510298,0.0970436510298,0.0970639677814,0.0962252841974,0.0969564074376,0.0969564074376,0.0969564074376,0.0969564074376,0.104892581334,0.120834628365,0.129318620896,0.134693646086,0.135846980577,0.136042841685,0.1401438211,0.135627574818,0.131641627349,0.122915974833,0.122915974833,0.122910469159,0.122910469159,0.121492748208,0.117253780834,0.117253780834,0.115044168381,0.115044168381,0.117253780834,0.117253780834,0.116553027097,0.115044168381,0.115044168381)
L_hpd_M95=c(0.362356556715, 0.362356556715,0.362356556715,0.362303869284,0.362356556715,0.332924308123,0.151479812079,0.140997060397,0.140720232634,0.139268198898,0.139745282115,0.140300287314,0.141206517382,0.148028765389,0.150065396974,0.159822283936,0.173035069282,0.180595887487,0.186084633809,0.187101918173,0.217011247534,0.21999034744,0.21999034744,0.21999034744,0.21999034744,0.21850489274,0.21999034744,0.222411209864,0.226658720254,0.261132770985,0.333287351427,0.357865356026,0.36816353508,0.382495501908,0.398469854353,0.398469854353,0.402509342497,0.401354430078,0.404104346091,0.398469854353,0.401589030115,0.405873357947,0.406494061889,0.409988237203,0.416474602041,0.416474602041,0.42269221092,0.424843407381,0.428903845585,0.430174560003,0.430775951265,0.430174560003,0.430174560003)
M_hpd_m95=c(0.861535478629, 0.861535478629,0.0967320077221,0.0967320077221,0.0967320077221,0.0950812872744,0.0963824652793,0.0959221215625,0.0963081435191,0.0960694162352,0.0950700582166,0.0959221215625,0.0940968984542,0.0940968984542,0.0950700582166,0.0950700582166,0.0940968984542,0.0948477329196,0.0940968984542,0.0943157325861,0.0903042351876,0.0903042351876,0.0767429336185,0.0616722157836,0.0538022665995,0.0515992931405,0.0524393699869,0.0515992931405,0.0521477350761,0.0515992931405,0.0489762603914,0.0491968130765,0.0500832666914,0.0489762603914,0.0489762603914,0.0394778282217,0.0380119829029,0.0367886127536,0.0380119829029,0.0309883940601,0.0281105098773,0.0281105098773,0.0125063201909,0.0135208686199,0.0135208686199,0.0135208686199,0.0135208686199,0.0135208686199,0.0135208686199,0.0135208686199,0.0135208686199,0.0135208686199,0.0135208686199)
M_hpd_M95=c(1.48860014486, 1.48860014486,0.151824460421,0.151824460421,0.151824460421,0.14925319131,0.149326763142,0.148286192527,0.148300021979,0.147578327604,0.146274196559,0.147239620831,0.145424855178,0.145260772552,0.146689226431,0.146880589041,0.146083585008,0.147578327604,0.147114535238,0.148300021979,0.146083585008,0.148971559917,0.149539616051,0.141889314967,0.132739134802,0.129635407984,0.128011428028,0.12631409597,0.12643143791,0.12631409597,0.123922520725,0.12469792092,0.12643143791,0.126544760497,0.127882638523,0.121764436946,0.12159825136,0.122093115429,0.129236542143,0.132663383175,0.147614986174,0.16919683247,0.162925497935,0.166723928842,0.166723928842,0.166723928842,0.166723928842,0.166723928842,0.166723928842,0.166723928842,0.166723928842,0.166723928842,0.166723928842)
R_hpd_m95=c(-1.23236979876, -1.23236979876,0.0374751020776,0.0376287177592,0.0253947827135,-0.0716540986656,-0.0903202389758,-0.0876401413288,-0.0855976864129,-0.0854346320618,-0.0848695434368,-0.08104031966,-0.08104031966,-0.0819905712073,-0.0819905712073,-0.0795216578221,-0.0650247273086,-0.0616604678735,-0.0612238126742,-0.0616417280471,-0.0477524183192,-0.0317020126093,-0.0280165626689,-0.0193994421599,-0.0156278655437,-0.00824588515173,-0.0078127573818,-0.00770575881189,-0.00756161331658,-0.0133210926176,0.00292914867854,0.0287430752025,0.0294617247575,0.0307751257089,0.0386436766472,0.0361084659608,0.0307751257089,0.0348495221501,0.028759074084,0.0333895388904,0.0293019210318,0.0170379076572,0.0146997111865,0.0082752792738,0.0082752792738,-0.0102224359766,-0.0137964584117,-0.0148449744025,-0.00560532024499,-0.0192847500517,-0.0113691817977,-0.0113691817977,-0.0113691817977)
R_hpd_M95=c(-0.575651418594, -0.575651418594,0.252544652273,0.253198940535,0.255034921892,0.223312156739,0.0340228436382,0.0267458585375,0.0266876583493,0.0267458585375,0.0266876583493,0.0304772493273,0.0307892879904,0.030276461053,0.0313921423143,0.0413553912842,0.0647796168413,0.0686415607953,0.0706315814058,0.0743886375107,0.100011467899,0.111289780731,0.117633306566,0.13089736718,0.133227768715,0.140647242263,0.141177612632,0.144639389796,0.148772832701,0.181770593801,0.249855718758,0.282221223827,0.282221223827,0.299617524643,0.318616406818,0.318616406818,0.318273634575,0.328705297029,0.330988362392,0.344516474406,0.355631358612,0.360092656555,0.361800612973,0.360834214231,0.371823045183,0.360834214231,0.360834214231,0.361800612973,0.372537104147,0.361800612973,0.371194833244,0.372537104147,0.372537104147)
L_mean=c(0.27770003797, 0.27770003797,0.277762977659,0.2777137719,0.274332164101,0.196551018359,0.0919582223981,0.0895926571569,0.0893398266873,0.0895028683624,0.0897004320323,0.0901638956662,0.0906801553035,0.0911128976991,0.092193321366,0.0970613173491,0.111195861813,0.117680732251,0.119995913301,0.124263987633,0.147163960448,0.158431527887,0.158801982844,0.159061497842,0.159127770539,0.15887227574,0.159586114092,0.160895704041,0.163523907044,0.172507362535,0.203116008572,0.225071063497,0.234299774492,0.245485457121,0.259025015097,0.260843976171,0.261166930091,0.261480970412,0.262952095541,0.262699778128,0.263310395188,0.263728375221,0.263613238161,0.263727944055,0.264469642707,0.263298402036,0.262444553379,0.262176748641,0.262363521252,0.262796170656,0.26294619658,0.263596078456,0.263596078456)
M_mean=c(1.15728121204, 1.15728121204,0.121681961845,0.121669724805,0.12165110295,0.121609446767,0.120989567059,0.120804467154,0.120641126792,0.120408926799,0.120062780839,0.119994227264,0.119974174709,0.119757505041,0.119613864158,0.11947123842,0.119338769341,0.11920510786,0.119202611916,0.119253962846,0.119449005019,0.118813872892,0.115897802098,0.107797273453,0.0974744113123,0.0930328742414,0.0910483809861,0.0898382414267,0.0892332838775,0.0884236291393,0.0873752618274,0.0864346340139,0.0860116766362,0.0855891930842,0.0846563366197,0.0824863015035,0.081374419125,0.0812574008416,0.0820069250857,0.0833565280324,0.0853536394206,0.0871562879819,0.0880652581401,0.0884703970914,0.0884703970914,0.0884703970914,0.0884703970914,0.0884703970914,0.0884703970914,0.0884703970914,0.0884703970914,0.0884703970914,0.0884703970914)
R_mean=c(-0.879581174066, -0.879581174066,0.156081015814,0.156044047094,0.15268106115,0.0749415715928,-0.0290313446607,-0.0312118099973,-0.0313013001048,-0.0309060584363,-0.0303623488068,-0.0298303315974,-0.0292940194054,-0.0286446073415,-0.0274205427919,-0.0224099210708,-0.00814290752816,-0.0015243756093,0.000793301384205,0.00501002478758,0.0277149554299,0.0396176549954,0.0429041807457,0.0512642243888,0.0616533592267,0.0658394014983,0.068537733106,0.0710574626145,0.0742906231665,0.0840837333954,0.115740746745,0.138636429483,0.148288097856,0.159896264037,0.174368678478,0.178357674668,0.179792510966,0.18022356957,0.180945170455,0.179343250096,0.177956755767,0.17657208724,0.175547980021,0.175257546964,0.175999245616,0.174828004945,0.173974156288,0.173706351549,0.17389312416,0.174325773565,0.174475799489,0.175125681365,0.175125681365)
trans=0.5
age=(0:(53-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.473853546391), xlim = c(-55.65,2.65), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.63746015935), xlim = c(-55.65,2.65), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.35560677864, 0.409790814561), xlim = c(-55.65,2.65), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-55.65,2.65), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()