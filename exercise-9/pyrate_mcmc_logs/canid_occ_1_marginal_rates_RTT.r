# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.184741397977, 0.184741397977,0.184741397977,0.184741397977,0.149920155878,0.0477365592688,0.0387526669654,0.0421714959346,0.0421714959346,0.0421714959346,0.0421714959346,0.050318229028,0.050318229028,0.050318229028,0.050318229028,0.0421714959346,0.0421714959346,0.0387526669654,0.0421714959346,0.0513156821095,0.0914788968791,0.137662912038,0.137662912038,0.142765982104,0.142765982104,0.145456741624,0.143778865146,0.137662912038,0.1394216105,0.148998490749,0.1394216105,0.148998490749,0.148998490749,0.15485184639,0.148998490749,0.146651655514,0.146410762068,0.146410762068,0.146410762068,0.133332386005,0.115036184003,0.137497678403,0.135120388382,0.124625029212,0.119214829949,0.115036184003,0.0569912207987,0.0569912207987,0.0569912207987,0.0569912207987,0.0569912207987,0.0569912207987,0.0569912207987,0.0569912207987)
L_hpd_M95=c(0.375826989523, 0.375826989523,0.375826989523,0.375826989523,0.375826989523,0.335741696786,0.149920155878,0.115036184003,0.115036184003,0.11449004461,0.11449004461,0.122284674053,0.122284674053,0.122284674053,0.122284674053,0.11449004461,0.11449004461,0.115036184003,0.1394216105,0.198728135833,0.248197572464,0.249677676173,0.249677676173,0.249677676173,0.248197572464,0.249677676173,0.249677676173,0.25220234338,0.263665139646,0.278994568428,0.29582195746,0.350494420401,0.36852288589,0.375487415911,0.386822622182,0.386822622182,0.373056207655,0.375487415911,0.386822622182,0.377130165011,0.377130165011,0.411783275837,0.409394974763,0.409394974763,0.411783275837,0.411783275837,0.390083411405,0.390083411405,0.390083411405,0.400752916458,0.400752916458,0.40369739188,0.40369739188,0.40369739188)
M_hpd_m95=c(0.913386147077, 0.913386147077,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0908332973847,0.0807991119148,0.0847697185921,0.0847697185921,0.070730622029,0.0473165492863,0.0411350819339,0.0411350819339,0.0411350819339,0.0411350819339,0.0411350819339,0.0411350819339,0.0411350819339,0.0411350819339)
M_hpd_M95=c(1.48987128368, 1.48987128368,0.126665742097,0.126665742097,0.126665742097,0.126665742097,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126423743822,0.126665742097,0.126665742097,0.126665742097,0.128919372643,0.128919372643,0.174092051797,0.252650780029,0.252650780029,0.28448978701,0.298729211772,0.298729211772,0.298729211772,0.298729211772,0.298729211772,0.298729211772,0.298729211772,0.298729211772,0.298729211772)
R_hpd_m95=c(-1.17426641075, -1.17426641075,0.0912587356787,0.0912587356787,0.0385216432763,-0.06648151191,-0.0784320930895,-0.0760522072838,-0.0760522072838,-0.0739744746018,-0.0739744746018,-0.0739744746018,-0.0739744746018,-0.0739744746018,-0.0739744746018,-0.0739744746018,-0.0739744746018,-0.0784320930895,-0.0784320930895,-0.0720940162604,-0.018322417218,0.0162759972501,0.0162759972501,0.0237091140852,0.0289313809326,0.0289313809326,0.029867691463,0.0289313809326,0.0347172012275,0.0289313809326,0.0289313809326,0.0289313809326,0.0376224583968,0.0395354954358,0.0395354954358,0.0395354954358,0.0395354954358,0.0276565969007,0.0276565969007,0.0196043162299,0.0395354954358,0.00780238048347,-0.0215908559438,-0.0215908559438,-0.0515328761531,-0.0746006525461,-0.148842696714,-0.148842696714,-0.148842696714,-0.156533374933,-0.156533374933,-0.181481701968,-0.181481701968,-0.181481701968)
R_hpd_M95=c(-0.536096962103, -0.536096962103,0.285335592951,0.285335592951,0.285335592951,0.225733396317,0.0151843872624,0.000668065080857,0.000668065080857,0.0014812646715,0.0014812646715,0.0014812646715,0.0014812646715,0.0014812646715,0.0014812646715,0.0014812646715,0.0014812646715,0.0014812646715,0.0237091140852,0.0933803234578,0.137155158858,0.143675895245,0.143675895245,0.143675895245,0.143675895245,0.140458932967,0.143675895245,0.150470953216,0.168121014878,0.165772297534,0.193599132617,0.240857398329,0.264023286633,0.268536488172,0.276918035148,0.276918035148,0.264251770273,0.264251770273,0.268659352196,0.268659352196,0.301734451187,0.316459138164,0.315050783891,0.324906774924,0.316459138164,0.314553657688,0.311554907226,0.314553657688,0.314553657688,0.314553657688,0.314553657688,0.301654326418,0.301654326418,0.301654326418)
L_mean=c(0.284682941226, 0.284682941226,0.284682941226,0.284682941226,0.279336384605,0.194682886158,0.0773929602802,0.0729208650138,0.0729208650138,0.0723217186532,0.0724458865243,0.0725229909092,0.0723752905533,0.0723752905533,0.0723752905533,0.0724612673176,0.0724612673176,0.0730629077097,0.0757636283765,0.101675995071,0.185041324832,0.190773687845,0.190773687845,0.191782285576,0.192238002151,0.193158427032,0.19371175982,0.19617709154,0.198908006912,0.19990474637,0.205571661916,0.228438465096,0.246425454188,0.250864501526,0.257498781776,0.261081699896,0.256661609339,0.252889564854,0.255615437297,0.256129029252,0.257676083811,0.258450120045,0.258913537715,0.257084018133,0.25651066412,0.2541403344,0.23242126966,0.223838248236,0.220555715695,0.221374553228,0.221649734255,0.223517944857,0.223517944857,0.223517944857)
M_mean=c(1.16844459689, 1.16844459689,0.108883599899,0.108883599899,0.108883599899,0.108819633874,0.108639337862,0.108639337862,0.108639337862,0.108639337862,0.108639337862,0.108639337862,0.108639337862,0.108639337862,0.108639337862,0.108639337862,0.108639337862,0.108639337862,0.108639337862,0.108639337862,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108595033204,0.108670045329,0.108670045329,0.108670045329,0.108979408269,0.108941188786,0.117269089061,0.12842548509,0.131010210116,0.136910646827,0.143790689131,0.145213955588,0.145213955588,0.145213955588,0.145213955588,0.145213955588,0.145213955588,0.145213955588,0.145213955588)
R_mean=c(-0.883761655662, -0.883761655662,0.175799341327,0.175799341327,0.170452784706,0.0858632522847,-0.0312463775819,-0.0357184728484,-0.0357184728484,-0.036317619209,-0.0361934513379,-0.036116346953,-0.0362640473089,-0.0362640473089,-0.0362640473089,-0.0361780705445,-0.0361780705445,-0.0355764301525,-0.0328757094857,-0.00696334279131,0.0764462916285,0.0821786546416,0.0821786546416,0.0831872523725,0.0836429689477,0.0845633938284,0.0851167266165,0.0875820583362,0.0903129737086,0.0913097131662,0.0969766287129,0.119843431893,0.137830420984,0.142269468322,0.148903748572,0.152486666692,0.147991564011,0.144219519525,0.146945391968,0.147149620983,0.148734895025,0.141181030984,0.130488052625,0.126073808016,0.119600017293,0.110349645268,0.0872073140718,0.0786242926486,0.0753417601066,0.0761605976403,0.0764357786673,0.0783039892696,0.0783039892696,0.0783039892696)
trans=0.5
age=(0:(54-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.452961603421), xlim = c(-56.7,2.7), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.63885841204), xlim = c(-56.7,2.7), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.29169305183, 0.357397452416), xlim = c(-56.7,2.7), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-56.7,2.7), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()